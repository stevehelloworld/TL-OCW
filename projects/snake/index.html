<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pygameè²ªé£Ÿè›‡éŠæˆ²è£½ä½œæ•™å­¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Prism JS for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <!-- Chosen Palette: Slate & Amber -->
    <!-- Application Structure Plan: A multi-page SPA simulation. The tutorial is broken into major "Pages" (Part 1, Part 2, etc.). Sidebar navigation switches between these pages. Within each page, "Next" and "Previous" buttons guide the user through more granular sub-steps. The code viewer on the right dynamically displays only the code relevant to the current sub-step. This structure provides a highly focused, linear, and less overwhelming learning path as requested. -->
    <!-- Visualization & Content Choices: Tutorial Pages -> Sidebar Navigation -> Switches between major tutorial parts. Sub-steps -> Next/Previous Buttons -> Guides user through detailed steps within a part. Code -> Dynamic Code Viewer -> Displays small, manageable code snippets for each sub-step, ensuring clarity. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .nav-active {
            background-color: #f1f5f9; /* slate-100 */
            color: #f59e0b; /* amber-500 */
            border-left-color: #f59e0b; /* amber-500 */
        }
        .step-content {
            display: none;
        }
        .step-content.active {
            display: block;
        }
        .content-section h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e2e8f0; /* slate-200 */
        }
        .content-section h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        .content-section p, .content-section li {
            line-height: 1.75;
            color: #334155; /* slate-700 */
        }
        .content-section code:not(pre > code) {
            background-color: #f1f5f9; /* slate-100 */
            color: #475569; /* slate-600 */
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.9em;
        }
        /* PrismJS okaidia theme background override */
        pre[class*="language-"] {
            background: #1e293b; /* slate-800 */
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="flex min-h-screen">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="w-64 bg-white border-r border-slate-200 fixed top-0 left-0 h-full overflow-y-auto transition-transform -translate-x-full md:translate-x-0 z-20">
            <div class="p-4">
                <h2 class="text-xl font-bold text-slate-700">Pygame è²ªé£Ÿè›‡</h2>
                <p class="text-sm text-slate-500">éŠæˆ²è£½ä½œæ•™å­¸</p>
            </div>
            <nav id="table-of-contents" class="mt-4">
                <ul>
                    <!-- Navigation items will be injected by JS -->
                </ul>
            </nav>
        </aside>

        <!-- Mobile Menu Button -->
        <button id="menu-toggle" class="md:hidden fixed top-4 left-4 z-30 p-2 bg-white rounded-md shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
            </svg>
        </button>

        <!-- Main Content -->
        <main class="w-full md:ml-64 p-4 md:p-8 lg:p-12">
            <div id="main-grid" class="max-w-7xl mx-auto grid grid-cols-1 gap-8">
                <!-- Tutorial Text Column -->
                <div>
                    <div class="flex justify-end mb-4">
                        <button id="toggle-code-btn" class="bg-white border border-slate-300 hover:bg-slate-100 text-slate-700 text-sm font-medium py-2 px-4 rounded-lg shadow-sm">
                            é¡¯ç¤ºç¨‹å¼ç¢¼
                        </button>
                    </div>
                    <div id="tutorial-content" class="prose max-w-none">
                        <!-- Content sections will be injected and managed by JS -->
                    </div>
                </div>

                <!-- Code Viewer Column -->
                <div id="code-viewer-container" class="sticky top-0 h-screen overflow-hidden hidden">
                    <div class="h-full flex flex-col bg-slate-900 rounded-lg shadow-lg">
                        <div class="flex-shrink-0 p-4 flex justify-between items-center bg-slate-800/50 rounded-t-lg">
                            <h3 id="code-viewer-title" class="text-lg font-semibold text-white">ç•¶å‰æ­¥é©Ÿç¨‹å¼ç¢¼</h3>
                            <button id="copy-button" class="bg-slate-700 hover:bg-slate-600 text-white text-sm font-medium py-1 px-3 rounded-md transition-colors">
                                è¤‡è£½
                            </button>
                        </div>
                        <div class="flex-grow overflow-y-auto">
                            <pre class="h-full m-0 rounded-b-lg"><code id="code-display" class="language-python text-sm"></code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tutorialData = {
                'intro': {
                    title: 'ğŸ‘‹ æ­¡è¿',
                    steps: [
                        {
                            title: 'æ­¡è¿ä¾†åˆ°éŠæˆ²é–‹ç™¼çš„ä¸–ç•Œï¼',
                            content: `
                                <p>æ­¡è¿å„ä½å‰›å­¸æœƒ Python åŸºç¤çš„ç¨‹å¼è¨­è¨ˆå¸«ï¼æº–å‚™å¥½å°‡ä½ çš„æŠ€èƒ½æå‡åˆ°ä¸€å€‹å…¨æ–°çš„ã€ä»¤äººèˆˆå¥®çš„å±¤æ¬¡äº†å—ï¼Ÿåœ¨æœ¬æ•™å­¸ä¸­ï¼Œæˆ‘å€‘å°‡ä¸€èµ·è¸ä¸Šä¸€æ®µæœ‰è¶£çš„æ—…ç¨‹ï¼šä½¿ç”¨ Pygame é€™å€‹å¼·å¤§ä¸”é©åˆåˆå­¸è€…çš„å‡½å¼åº«ï¼Œå¾é›¶é–‹å§‹æ‰“é€ ä¸€å€‹ç¶“å…¸çš„è²ªé£Ÿè›‡éŠæˆ²ã€‚</p>
                                <img src="./snake.png" alt="å®Œæˆçš„è²ªé£Ÿè›‡éŠæˆ²" class="rounded-lg shadow-md my-4">
                                <p>æœ¬æ•™å­¸æ¡ç”¨åˆ†é ã€åˆ†æ­¥é©Ÿçš„æ–¹å¼é€²è¡Œã€‚è«‹é»æ“Šå·¦å´çš„å°è¦½åˆ—ä¾†åˆ‡æ›ä¸»è¦ç« ç¯€ï¼Œä¸¦ä½¿ç”¨ä¸‹æ–¹çš„ã€Œä¸‹ä¸€æ­¥ã€æŒ‰éˆ•ä¾†è·Ÿéš¨æ¯å€‹è©³ç´°æ­¥é©Ÿã€‚æ‚¨å¯ä»¥é»æ“Šå³ä¸Šæ–¹çš„ã€Œé¡¯ç¤ºç¨‹å¼ç¢¼ã€æŒ‰éˆ•ä¾†æŸ¥çœ‹èˆ‡è©²æ­¥é©Ÿå°æ‡‰çš„ç¨‹å¼ç¢¼ã€‚</p>
                                <p>ç¾åœ¨ï¼Œé»æ“Šã€Œä¸‹ä¸€æ­¥ã€æˆ–å·¦å´çš„ã€ŒPart 1ã€é–‹å§‹æˆ‘å€‘çš„æ—…ç¨‹å§ï¼</p>`,
                            code: `# æ­¡è¿ä¾†åˆ° Pygame è²ªé£Ÿè›‡æ•™å­¸ï¼\n# è«‹é»æ“Šã€Œä¸‹ä¸€æ­¥ã€é–‹å§‹ã€‚`
                        }
                    ]
                },
                'part1': {
                    title: 'Part 1: æ­å»ºèˆå°',
                    steps: [
                        {
                            title: '1.1: åŒ¯å…¥èˆ‡åˆå§‹åŒ–',
                            content: `<p>ä»»ä½• Pygame ç¨‹å¼çš„ç¬¬ä¸€æ­¥éƒ½æ˜¯åŒ¯å…¥å¿…è¦çš„å‡½å¼åº«ä¸¦åˆå§‹åŒ– Pygame å¼•æ“ã€‚é€™å°±åƒæ˜¯ç‚ºæˆ‘å€‘çš„è¡¨æ¼”æº–å‚™å¥½èˆå°å’Œç‡ˆå…‰ã€‚</p>
                                       <ul>
                                           <li><code>import pygame, sys, random, time</code>: åŒ¯å…¥æˆ‘å€‘æ•´å€‹å°ˆæ¡ˆæœƒç”¨åˆ°çš„æ‰€æœ‰å‡½å¼åº«ã€‚</li>
                                           <li><code>pygame.init()</code>: é€™æ˜¯å•Ÿå‹• Pygame çš„é­”æ³•æŒ‡ä»¤ï¼Œå¿…é ˆåœ¨æ‰€æœ‰å…¶ä»– Pygame åŠŸèƒ½ä¹‹å‰å‘¼å«ã€‚</li>
                                       </ul>`,
                            code: `# åŒ¯å…¥å‡½å¼åº«
import pygame
import sys
import time
import random

# åˆå§‹åŒ– Pygame
pygame.init()`
                        },
                        {
                            title: '1.2: å»ºç«‹éŠæˆ²è¦–çª—',
                            content: `<p>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘è¦å®šç¾©éŠæˆ²è¦–çª—çš„å¤§å°ï¼Œä¸¦å¯¦éš›å»ºç«‹å‡ºé€™å€‹è¦–çª—ã€‚æˆ‘å€‘ä¹Ÿæœƒç‚ºå®ƒè¨­å®šä¸€å€‹æ¨™é¡Œã€‚</p>
                                       <ul>
                                           <li><code>screen_width</code> å’Œ <code>screen_height</code>: å®šç¾©è¦–çª—çš„å¯¬èˆ‡é«˜ã€‚</li>
                                           <li><code>BLOCK_SIZE</code>: å®šç¾©éŠæˆ²ä¸­ç¶²æ ¼çš„å¤§å°ï¼Œé€™å°ä¹‹å¾Œè›‡å’Œé£Ÿç‰©çš„å®šä½éå¸¸é‡è¦ã€‚</li>
                                           <li><code>pygame.display.set_mode()</code>: æ ¹æ“šå°ºå¯¸å»ºç«‹è¦–çª—ã€‚</li>
                                           <li><code>pygame.display.set_caption()</code>: è¨­å®šè¦–çª—æ¨™é¡Œã€‚</li>
                                       </ul>`,
                            code: `# è¦–çª—å°ºå¯¸
screen_width = 720
screen_height = 480

# ç¶²æ ¼å°ºå¯¸
BLOCK_SIZE = 20

# å»ºç«‹éŠæˆ²è¦–çª—
screen = pygame.display.set_mode((screen_width, screen_height))
pygame.display.set_caption('è²ªé£Ÿè›‡')`
                        },
                        {
                            title: '1.3: é¡è‰²èˆ‡æ™‚é˜',
                            content: `<p>æˆ‘å€‘é å…ˆå®šç¾©å¥½éŠæˆ²ä¸­æœƒç”¨åˆ°çš„é¡è‰²ï¼Œä¸¦å»ºç«‹ä¸€å€‹æ™‚é˜ç‰©ä»¶ä¾†æ§åˆ¶éŠæˆ²çš„æ›´æ–°é€Ÿåº¦ï¼ˆå¹€ç‡ï¼‰ã€‚</p>
                                       <ul>
                                           <li>é¡è‰²æ˜¯ç”¨ <code>(R, G, B)</code> å…ƒçµ„å®šç¾©çš„ã€‚</li>
                                           <li><code>pygame.time.Clock()</code>: å»ºç«‹ä¸€å€‹æ™‚é˜ç‰©ä»¶ï¼Œç”¨ä¾†ç©©å®šéŠæˆ²é€Ÿåº¦ã€‚</li>
                                       </ul>`,
                            code: `# é¡è‰²å®šç¾©
BLACK = pygame.Color(0, 0, 0)
WHITE = pygame.Color(255, 255, 255)
RED = pygame.Color(255, 0, 0)
GREEN = pygame.Color(0, 255, 0)

# FPS æ§åˆ¶å™¨
clock = pygame.time.Clock()
snake_speed = 15`
                        },
                        {
                            title: '1.4: ä¸»éŠæˆ²è¿´åœˆ',
                            content: `<p>é€™æ˜¯éŠæˆ²çš„å¿ƒè‡Ÿã€‚ä¸€å€‹ <code>while</code> è¿´åœˆæœƒä¸æ–·åŸ·è¡Œï¼Œè™•ç†äº‹ä»¶ã€æ›´æ–°é‚è¼¯ä¸¦é‡æ–°ç¹ªè£½ç•«é¢ã€‚ç›®å‰ï¼Œå®ƒåªæœƒè™•ç†ã€Œé—œé–‰è¦–çª—ã€äº‹ä»¶ï¼Œä¸¦ç”¨é»‘è‰²å¡«æ»¿èƒŒæ™¯ã€‚</p>
                                       <ul>
                                           <li><code>while True:</code>: å»ºç«‹ä¸€å€‹ç„¡é™è¿´åœˆã€‚</li>
                                           <li><code>pygame.event.get()</code>: æª¢æŸ¥æ‰€æœ‰ä½¿ç”¨è€…è¼¸å…¥ã€‚</li>
                                           <li><code>screen.fill()</code>: æ¸…ç©ºä¸¦å¡«æ»¿èƒŒæ™¯ã€‚</li>
                                           <li><code>pygame.display.update()</code>: å°‡æ‰€æœ‰ç¹ªè£½æ›´æ–°åˆ°è¢å¹•ä¸Šã€‚</li>
                                           <li><code>clock.tick()</code>: æ§åˆ¶è¿´åœˆæ¯ç§’åŸ·è¡Œçš„æ¬¡æ•¸ã€‚</li>
                                       </ul>
                                       <p class="mt-4 font-bold">æ­å–œï¼Part 1 å·²å®Œæˆã€‚é»æ“Šã€Œä¸‹ä¸€æ­¥ã€é€²å…¥ Part 2ã€‚</p>`,
                            code: `# ä¸»éŠæˆ²è¿´åœˆ (æ­¤è¿´åœˆå°‡åœ¨ Part 4 è¢«ç§»å…¥ main å‡½å¼)
while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()

    # éŠæˆ²é‚è¼¯æ›´æ–° (æš«æ™‚ç‚ºç©º)

    # ç•«é¢æ¸²æŸ“
    screen.fill(BLACK)
    
    pygame.display.update()
    clock.tick(snake_speed)`
                        }
                    ]
                },
                'part2': {
                    title: 'Part 2: è®“è›‡æ´»èµ·ä¾†',
                    steps: [
                        {
                            title: '2.1: è›‡çš„è³‡æ–™çµæ§‹',
                            content: `<p>æˆ‘å€‘éœ€è¦ç”¨è®Šæ•¸ä¾†å„²å­˜è›‡çš„ç‹€æ…‹ã€‚æœ€ç›´è§€çš„æ–¹å¼æ˜¯ç”¨ä¸€å€‹åˆ—è¡¨ (list) ä¾†ä»£è¡¨è›‡çš„èº«é«”ï¼Œåˆ—è¡¨ä¸­çš„æ¯å€‹å…ƒç´ éƒ½æ˜¯ä¸€å€‹åº§æ¨™ã€‚</p>
                                       <ul>
                                           <li><code>snake_pos</code>: è›‡é ­çš„ <code>[x, y]</code> åº§æ¨™ã€‚</li>
                                           <li><code>snake_body</code>: ä¸€å€‹åˆ—è¡¨çš„åˆ—è¡¨ï¼Œå„²å­˜è›‡æ¯ä¸€ç¯€èº«é«”çš„åº§æ¨™ã€‚</li>
                                           <li><code>direction</code>: å„²å­˜è›‡ç•¶å‰çš„ç§»å‹•æ–¹å‘ã€‚</li>
                                       </ul>
                                       <p>è«‹å°‡é€™æ®µç¨‹å¼ç¢¼åŠ åœ¨ <code>snake_speed = 15</code> ä¹‹å¾Œã€‚</p>`,
                            code: `# éŠæˆ²è®Šæ•¸
snake_pos = [100, 60]
snake_body = [[100, 60], [80, 60], [60, 60]]
direction = 'RIGHT'
change_to = direction`
                        },
                        {
                            title: '2.2: ç¹ªè£½è›‡',
                            content: `<p>æœ‰äº†è›‡çš„è³‡æ–™ï¼Œæˆ‘å€‘å°±å¯ä»¥åœ¨éŠæˆ²è¿´åœˆçš„ã€Œç•«é¢æ¸²æŸ“ã€å€å¡ŠæŠŠå®ƒç•«å‡ºä¾†ã€‚æˆ‘å€‘éæ­· <code>snake_body</code> åˆ—è¡¨ï¼Œç‚ºæ¯å€‹åº§æ¨™é»ç•«ä¸€å€‹ç¶ è‰²çš„æ–¹å¡Šã€‚</p>
                                       <p>è«‹å°‡é€™æ®µç¨‹å¼ç¢¼åŠ åœ¨ <code>screen.fill(BLACK)</code> ä¹‹å¾Œã€‚</p>`,
                            code: `# ç•«è›‡
for pos in snake_body:
    pygame.draw.rect(screen, GREEN, pygame.Rect(pos[0], pos[1], BLOCK_SIZE, BLOCK_SIZE))`
                        },
                        {
                            title: '2.3: éµç›¤æ§åˆ¶',
                            content: `<p>ç‚ºäº†è®“ç©å®¶èƒ½æ§åˆ¶è›‡ï¼Œæˆ‘å€‘éœ€è¦åœ¨äº‹ä»¶è™•ç†è¿´åœˆä¸­åµæ¸¬éµç›¤æŒ‰ä¸‹ (<code>KEYDOWN</code>) äº‹ä»¶ï¼Œä¸¦æ ¹æ“šæŒ‰ä¸‹çš„æ–¹å‘éµä¾†æ›´æ–° <code>change_to</code> è®Šæ•¸ã€‚</p>
                                       <p>è«‹å°‡é€™æ®µç¨‹å¼ç¢¼åŠ åœ¨ <code>for event in pygame.event.get():</code> è¿´åœˆå…§éƒ¨ã€‚</p>`,
                            code: `# éµç›¤è¼¸å…¥
if event.type == pygame.KEYDOWN:
    if (event.key == pygame.K_UP or event.key == ord('w')) and direction != 'DOWN':
        change_to = 'UP'
    if (event.key == pygame.K_DOWN or event.key == ord('s')) and direction != 'UP':
        change_to = 'DOWN'
    if (event.key == pygame.K_LEFT or event.key == ord('a')) and direction != 'RIGHT':
        change_to = 'LEFT'
    if (event.key == pygame.K_RIGHT or event.key == ord('d')) and direction != 'LEFT':
        change_to = 'RIGHT'`
                        },
                        {
                            title: '2.4: ç§»å‹•é‚è¼¯',
                            content: `<p>é€™æ˜¯è®“è›‡å‹•èµ·ä¾†çš„æ ¸å¿ƒã€‚æˆ‘å€‘æ ¹æ“šæ–¹å‘æ›´æ–°è›‡é ­çš„ä½ç½®ï¼Œç„¶å¾Œåœ¨è›‡èº«é«”åˆ—è¡¨çš„é ­éƒ¨æ’å…¥æ–°ä½ç½®ï¼Œä¸¦ç§»é™¤å°¾éƒ¨ã€‚é€™ä¸€å¢ä¸€æ¸›ï¼Œå°±æ¨¡æ“¬å‡ºäº†ç§»å‹•çš„æ•ˆæœã€‚</p>
                                       <p>è«‹å°‡é€™æ®µç¨‹å¼ç¢¼åŠ åœ¨ã€ŒéŠæˆ²é‚è¼¯æ›´æ–°ã€å€å¡Šã€‚</p>
                                       <p class="mt-4 font-bold">å¤ªæ£’äº†ï¼Part 2 å·²å®Œæˆã€‚é»æ“Šã€Œä¸‹ä¸€æ­¥ã€ä¾†ç‚ºéŠæˆ²åŠ å…¥æ›´å¤šæ©Ÿåˆ¶ã€‚</p>`,
                            code: `# é˜²æ­¢180åº¦è½‰å½
direction = change_to

# æ›´æ–°è›‡é ­ä½ç½®
if direction == 'UP':
    snake_pos[1] -= BLOCK_SIZE
if direction == 'DOWN':
    snake_pos[1] += BLOCK_SIZE
if direction == 'LEFT':
    snake_pos[0] -= BLOCK_SIZE
if direction == 'RIGHT':
    snake_pos[0] += BLOCK_SIZE

# è›‡èº«é«”ç§»å‹•æ©Ÿåˆ¶
snake_body.insert(0, list(snake_pos))
snake_body.pop()`
                        }
                    ]
                },
                 'part3': {
                    title: 'Part 3: æ ¸å¿ƒéŠæˆ²æ©Ÿåˆ¶',
                    steps: [
                        {
                            title: '3.1: ç”¢ç”Ÿé£Ÿç‰©',
                            content: `<p>éŠæˆ²éœ€è¦ä¸€å€‹ç›®æ¨™ï¼Œé‚£å°±æ˜¯é£Ÿç‰©ã€‚æˆ‘å€‘ä¾†å¯«ä¸€å€‹å‡½å¼ï¼Œå®ƒå¯ä»¥åœ¨ä¸€å€‹éš¨æ©Ÿã€ä¸”ä¸èˆ‡è›‡èº«é‡ç–Šçš„ä½ç½®ç”¢ç”Ÿé£Ÿç‰©ã€‚</p>
                                       <p>è«‹å°‡é€™å€‹å‡½å¼åŠ åœ¨ç¨‹å¼ç¢¼çš„é ‚éƒ¨å€åŸŸ (import ä¹‹å¾Œ)ã€‚</p>`,
                            code: `def generate_food(snake_body):
    while True:
        pos = [random.randrange(0, screen_width // BLOCK_SIZE) * BLOCK_SIZE, 
               random.randrange(0, screen_height // BLOCK_SIZE) * BLOCK_SIZE]
        if pos not in snake_body:
            return pos`
                        },
                        {
                            title: '3.2: é¡¯ç¤ºåˆ†æ•¸',
                            content: `<p>æˆ‘å€‘ä¹Ÿéœ€è¦ä¸€å€‹å‡½å¼ä¾†åœ¨è¢å¹•ä¸Šé¡¯ç¤ºç•¶å‰åˆ†æ•¸ã€‚</p>
                                       <p>è«‹å°‡é€™å€‹å‡½å¼ä¹ŸåŠ åœ¨ç¨‹å¼ç¢¼çš„é ‚éƒ¨å€åŸŸã€‚</p>`,
                            code: `def show_score(score):
    score_font = pygame.font.SysFont('consolas', 20)
    score_surface = score_font.render('Score : ' + str(score), True, WHITE)
    score_rect = score_surface.get_rect()
    score_rect.midtop = (screen_width / 10, 15)
    screen.blit(score_surface, score_rect)`
                        },
                        {
                            title: '3.3: ç¢°æ’èˆ‡æˆé•·',
                            content: `<p>ç¾åœ¨ä¾†ä¿®æ”¹éŠæˆ²é‚è¼¯ã€‚æˆ‘å€‘éœ€è¦åˆå§‹åŒ–åˆ†æ•¸å’Œé£Ÿç‰©ä½ç½®ï¼Œä¸¦åœ¨è›‡é ­ç¢°åˆ°é£Ÿç‰©æ™‚ï¼Œå¢åŠ åˆ†æ•¸ä¸¦é‡æ–°ç”¢ç”Ÿé£Ÿç‰©ï¼ŒåŒæ™‚è®“è›‡èº«è®Šé•·ï¼ˆé€éä¸ç§»é™¤è›‡å°¾ä¾†å¯¦ç¾ï¼‰ã€‚</p>
                                       <p>è«‹ç”¨é€™æ®µç¨‹å¼ç¢¼æ›¿æ›æ‰èˆŠçš„è®Šæ•¸å®šç¾©å’Œ <code>snake_body.pop()</code> é‚è¼¯ã€‚</p>`,
                            code: `# åœ¨è®Šæ•¸å®šç¾©å€
score = 0
food_pos = generate_food(snake_body)

# åœ¨ä¸»è¿´åœˆä¸­ï¼Œæ›¿æ›æ‰ snake_body.pop()
if snake_pos[0] == food_pos[0] and snake_pos[1] == food_pos[1]:
    score += 10
    food_pos = generate_food(snake_body)
else:
    snake_body.pop()`
                        },
                        {
                            title: '3.4: å¤±æ•—æ¢ä»¶èˆ‡ç¹ªåœ–',
                            content: `<p>æœ€å¾Œï¼Œæˆ‘å€‘è¦åŠ å…¥å¤±æ•—æ¢ä»¶ï¼ˆæ’ç‰†æˆ–æ’è‡ªå·±ï¼‰ï¼Œä¸¦æŠŠé£Ÿç‰©å’Œåˆ†æ•¸ç•«å‡ºä¾†ã€‚</p>
                                       <p>è«‹å°‡é€™æ®µç¨‹å¼ç¢¼åŠ åˆ°éŠæˆ²è¿´åœˆçš„å°æ‡‰ä½ç½®ã€‚</p>
                                       <p class="mt-4 font-bold">æ ¸å¿ƒæ©Ÿåˆ¶å®Œæˆï¼é»æ“Šã€Œä¸‹ä¸€æ­¥ã€ä¾†å®Œå–„éŠæˆ²é«”é©—ã€‚</p>`,
                            code: `# åœ¨éŠæˆ²é‚è¼¯æ›´æ–°å€å¡Šçš„çµå°¾æ–°å¢ï¼š
if snake_pos[0] < 0 or snake_pos[0] >= screen_width or snake_pos[1] < 0 or snake_pos[1] >= screen_height:
    pass # å°‡åœ¨ Part 4 è™•ç†
for block in snake_body[1:]:
    if snake_pos[0] == block[0] and snake_pos[1] == block[1]:
        pass # å°‡åœ¨ Part 4 è™•ç†

# åœ¨ç•«é¢æ¸²æŸ“å€å¡Šæ–°å¢ï¼š
pygame.draw.rect(screen, RED, pygame.Rect(food_pos[0], food_pos[1], BLOCK_SIZE, BLOCK_SIZE))
show_score(score)`
                        }
                    ]
                },
                'part4': {
                    title: 'Part 4: å®Œå–„é«”é©—',
                     steps: [
                        {
                            title: '4.1: éŠæˆ²çµæŸç•«é¢',
                            content: `<p>ç•¶ç©å®¶å¤±æ•—æ™‚ï¼Œæˆ‘å€‘æ‡‰è©²é¡¯ç¤ºä¸€å€‹æ¸…æ™°çš„ã€ŒéŠæˆ²çµæŸã€ç•«é¢ï¼Œè€Œä¸æ˜¯è®“ç¨‹å¼ç›´æ¥å´©æ½°ã€‚é€™å€‹å‡½å¼æœƒé¡¯ç¤ºæ­»äº¡è¨Šæ¯ã€æœ€çµ‚åˆ†æ•¸ï¼Œä¸¦ç­‰å¾…ç©å®¶è¼¸å…¥ã€‚</p>
                                       <p>è«‹å°‡é€™å€‹å‡½å¼åŠ åœ¨ç¨‹å¼ç¢¼çš„é ‚éƒ¨å€åŸŸã€‚</p>`,
                            code: `def game_over_message(score):
    my_font = pygame.font.SysFont('times new roman', 90)
    game_over_surface = my_font.render('YOU DIED', True, RED)
    game_over_rect = game_over_surface.get_rect()
    game_over_rect.midtop = (screen_width / 2, screen_height / 4)
    screen.blit(game_over_surface, game_over_rect)
    
    # é€™è£¡å¯ä»¥å‘¼å« show_score ä¾†é¡¯ç¤ºæœ€çµ‚åˆ†æ•¸ï¼Œä½†æˆ‘å€‘éœ€è¦ç¨ä½œä¿®æ”¹
    # æš«æ™‚å…ˆé€™æ¨£
    final_score_font = pygame.font.SysFont('consolas', 20)
    final_score_surface = final_score_font.render('Final Score: ' + str(score), True, WHITE)
    final_score_rect = final_score_surface.get_rect()
    final_score_rect.midtop = (screen_width / 2, screen_height / 1.5)
    screen.blit(final_score_surface, final_score_rect)
    
    pygame.display.flip()
    
    time.sleep(2) # æš«åœå…©ç§’
    # æ¥ä¸‹ä¾†è¦è™•ç†é‡æ–°é–‹å§‹`
                        },
                        {
                            title: '4.2: é‡æ–°é–‹å§‹éŠæˆ²',
                            content: `<p>ç‚ºäº†èƒ½é‡æ–°é–‹å§‹éŠæˆ²ï¼Œæˆ‘å€‘éœ€è¦å°‡æ•´å€‹éŠæˆ²é‚è¼¯åŒ…è£é€²ä¸€å€‹ <code>main</code> å‡½å¼ï¼Œä¸¦åœ¨éŠæˆ²çµæŸæ™‚å†æ¬¡å‘¼å«å®ƒã€‚é€™æ˜¯ä¸€ç¨®ç°¡å–®çš„é‡å•Ÿæ–¹å¼ã€‚</p>
                                       <p>è«‹ç”¨é€™æ®µç¨‹å¼ç¢¼çµæ§‹ä¾†é‡çµ„ä½ çš„ç¨‹å¼ç¢¼ï¼Œä¸¦åœ¨æª”æ¡ˆåº•éƒ¨åŠ ä¸Šç¨‹å¼é€²å…¥é»ã€‚</p>`,
                            code: `# ä¿®æ”¹ game_over_message å‡½å¼ï¼ŒåŠ å…¥ç­‰å¾…è¿´åœˆ
def game_over_message(score):
    # ... (é¡¯ç¤ºæ–‡å­—çš„éƒ¨åˆ†) ...
    pygame.display.flip()
    waiting = True
    while waiting:
        for event in pygame.event.get():
            if event.type == pygame.QUIT or (event.type == pygame.KEYDOWN and event.key == pygame.K_q):
                pygame.quit()
                sys.exit()
            if event.type == pygame.KEYDOWN and event.key == pygame.K_r:
                waiting = False # çµæŸç­‰å¾…ï¼Œè¿”å› main å‡½å¼

# å»ºç«‹ main å‡½å¼
def main():
    # å°‡æ‰€æœ‰éŠæˆ²è®Šæ•¸åˆå§‹åŒ–å’Œä¸»è¿´åœˆéƒ½ç§»åˆ°é€™è£¡...

# åœ¨æª”æ¡ˆæœ€åº•éƒ¨æ–°å¢
if __name__ == '__main__':
    main()

# åœ¨ä¸»è¿´åœˆçš„å¤±æ•—æ¢ä»¶ä¸­ï¼Œå‘¼å« game_over_message å’Œ main
if is_game_over:
    game_over_message(score)
    main()`
                        },
                         {
                            title: '4.3: æœ€çµ‚æ•´åˆ',
                            content: `<p>é€™æ˜¯å°‡æ‰€æœ‰éƒ¨åˆ†æ•´åˆåœ¨ä¸€èµ·çš„æœ€çµ‚æ¨£è²Œã€‚å·¦å´çš„å°è¦½åˆ—ç¾åœ¨å¤šäº†ä¸€å€‹ã€Œæœ€çµ‚ç¨‹å¼ç¢¼ã€é¸é …ï¼Œä½ å¯ä»¥éš¨æ™‚é»æ“ŠæŸ¥çœ‹å®Œæ•´çš„ã€å¯åŸ·è¡Œçš„ç¨‹å¼ç¢¼ã€‚</p>
                                       <p class="mt-4 font-bold">æ­å–œä½ ï¼Œå®Œæˆäº†æ•´å€‹æ•™å­¸ï¼ä½ å·²ç¶“å¾é›¶æ‰“é€ äº†ä¸€å€‹å®Œæ•´çš„è²ªé£Ÿè›‡éŠæˆ²ï¼</p>`,
                            code: `# æœ€çµ‚ç¨‹å¼ç¢¼å±•ç¤ºåœ¨ã€Œæœ€çµ‚ç¨‹å¼ç¢¼ã€åˆ†é ä¸­ã€‚
# æ­å–œä½ å®Œæˆæ•™å­¸ï¼`
                        }
                    ]
                },
                'final': {
                    title: 'æœ€çµ‚ç¨‹å¼ç¢¼',
                    steps: [
                        {
                            title: 'å®Œæ•´ main.py',
                            content: `<p>é€™æ˜¯æ•´å€‹å°ˆæ¡ˆçš„æœ€çµ‚å®Œæ•´ç¨‹å¼ç¢¼ã€‚ä½ å¯ä»¥è¤‡è£½é€™æ®µç¨‹å¼ç¢¼åˆ°ä½ çš„ <code>main.py</code> æª”æ¡ˆä¸­ç›´æ¥åŸ·è¡Œã€‚</p>`,
                            code: `import pygame
import sys
import time
import random

# åˆå§‹åŒ– Pygame
pygame.init()

# è¦–çª—å°ºå¯¸
screen_width = 720
screen_height = 480
BLOCK_SIZE = 20

# å»ºç«‹éŠæˆ²è¦–çª—
screen = pygame.display.set_mode((screen_width, screen_height))
pygame.display.set_caption('è²ªé£Ÿè›‡æ–°æ‰‹æ‘')

# é¡è‰²å®šç¾©
BLACK = pygame.Color(0, 0, 0)
WHITE = pygame.Color(255, 255, 255)
RED = pygame.Color(255, 0, 0)
GREEN = pygame.Color(0, 255, 0)

# FPS æ§åˆ¶å™¨
clock = pygame.time.Clock()
snake_speed = 15

def show_score(score, choice=1):
    score_font = pygame.font.SysFont('consolas', 20)
    score_surface = score_font.render('Score : ' + str(score), True, WHITE)
    score_rect = score_surface.get_rect()
    if choice == 1:
        score_rect.midtop = (screen_width / 10, 15)
    else:
        score_rect.midtop = (screen_width / 2, screen_height / 1.5)
    screen.blit(score_surface, score_rect)

def game_over_message(score):
    my_font = pygame.font.SysFont('times new roman', 90)
    game_over_surface = my_font.render('YOU DIED', True, RED)
    game_over_rect = game_over_surface.get_rect()
    game_over_rect.midtop = (screen_width / 2, screen_height / 4)
    screen.blit(game_over_surface, game_over_rect)
    
    show_score(score, choice=0)

    restart_font = pygame.font.SysFont('consolas', 20)
    restart_surface = restart_font.render('Press [R] to Restart or [Q] to Quit', True, WHITE)
    restart_rect = restart_surface.get_rect()
    restart_rect.midtop = (screen_width / 2, screen_height / 1.25)
    screen.blit(restart_surface, restart_rect)
    
    pygame.display.flip()
    
    waiting = True
    while waiting:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
                sys.exit()
            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_q:
                    pygame.quit()
                    sys.exit()
                if event.key == pygame.K_r:
                    waiting = False

def main():
    def generate_food(snake_body):
        while True:
            pos = [random.randrange(0, screen_width // BLOCK_SIZE) * BLOCK_SIZE, 
                   random.randrange(0, screen_height // BLOCK_SIZE) * BLOCK_SIZE]
            if pos not in snake_body:
                return pos

    score = 0
    snake_pos = [100, 60]
    snake_body = [[100, 60], [80, 60], [60, 60]]
    food_pos = generate_food(snake_body)
    direction = 'RIGHT'
    change_to = direction

    while True:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
                sys.exit()
            if event.type == pygame.KEYDOWN:
                if (event.key == pygame.K_UP or event.key == ord('w')) and direction != 'DOWN':
                    change_to = 'UP'
                if (event.key == pygame.K_DOWN or event.key == ord('s')) and direction != 'UP':
                    change_to = 'DOWN'
                if (event.key == pygame.K_LEFT or event.key == ord('a')) and direction != 'RIGHT':
                    change_to = 'LEFT'
                if (event.key == pygame.K_RIGHT or event.key == ord('d')) and direction != 'LEFT':
                    change_to = 'RIGHT'

        direction = change_to

        if direction == 'UP': snake_pos[1] -= BLOCK_SIZE
        if direction == 'DOWN': snake_pos[1] += BLOCK_SIZE
        if direction == 'LEFT': snake_pos[0] -= BLOCK_SIZE
        if direction == 'RIGHT': snake_pos[0] += BLOCK_SIZE

        snake_body.insert(0, list(snake_pos))
        if snake_pos[0] == food_pos[0] and snake_pos[1] == food_pos[1]:
            score += 10
            food_pos = generate_food(snake_body)
        else:
            snake_body.pop()

        screen.fill(BLACK)
        for pos in snake_body:
            pygame.draw.rect(screen, GREEN, pygame.Rect(pos[0], pos[1], BLOCK_SIZE, BLOCK_SIZE))
        pygame.draw.rect(screen, RED, pygame.Rect(food_pos[0], food_pos[1], BLOCK_SIZE, BLOCK_SIZE))
        
        if snake_pos[0] < 0 or snake_pos[0] >= screen_width or snake_pos[1] < 0 or snake_pos[1] >= screen_height:
            game_over_message(score)
            main()
        for block in snake_body[1:]:
            if snake_pos[0] == block[0] and snake_pos[1] == block[1]:
                game_over_message(score)
                main()

        show_score(score)
        pygame.display.update()
        clock.tick(snake_speed)

if __name__ == '__main__':
    main()`
                        }
                    ]
                }
            };

            const toc = document.getElementById('table-of-contents').getElementsByTagName('ul')[0];
            const tutorialContent = document.getElementById('tutorial-content');
            const codeDisplay = document.getElementById('code-display');
            const copyButton = document.getElementById('copy-button');
            const codeTitle = document.getElementById('code-viewer-title');
            const toggleCodeBtn = document.getElementById('toggle-code-btn');
            const codeViewerContainer = document.getElementById('code-viewer-container');
            const mainGrid = document.getElementById('main-grid');
            
            let currentPage = 'intro';
            let currentStep = 0;
            let currentCode = '';

            function renderPage(pageId, startStep = 0) {
                currentPage = pageId;
                currentStep = startStep;
                
                const pageData = tutorialData[pageId];
                if (!pageData) return;

                tutorialContent.innerHTML = ''; // Clear previous content

                const pageContainer = document.createElement('div');
                pageContainer.id = `page-${pageId}`;
                pageContainer.classList.add('content-section');
                
                let stepsHtml = `<h3>${pageData.title}</h3>`;
                pageData.steps.forEach((step, index) => {
                    stepsHtml += `<div class="step-content ${index === startStep ? 'active' : ''}" data-step="${index}">
                                    <h4>${step.title}</h4>
                                    ${step.content}
                                  </div>`;
                });
                
                pageContainer.innerHTML = stepsHtml;

                const navigationButtons = document.createElement('div');
                navigationButtons.classList.add('mt-8', 'flex', 'justify-between');
                navigationButtons.innerHTML = `
                    <button class="prev-step-btn bg-slate-200 hover:bg-slate-300 text-slate-800 font-bold py-2 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed">
                        &larr; ä¸Šä¸€æ­¥
                    </button>
                    <button class="next-step-btn bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded">
                        ä¸‹ä¸€æ­¥ &rarr;
                    </button>
                `;
                pageContainer.appendChild(navigationButtons);
                tutorialContent.appendChild(pageContainer);

                updateStep();
                updateNavButtons();

                document.querySelector('.prev-step-btn').addEventListener('click', () => {
                    const pageKeys = Object.keys(tutorialData);
                    const currentPageIndex = pageKeys.indexOf(currentPage);

                    if (currentStep > 0) {
                        currentStep--;
                        updateStep();
                    } else if (currentPageIndex > 0) {
                        const prevPageId = pageKeys[currentPageIndex - 1];
                        const prevPageData = tutorialData[prevPageId];
                        renderPage(prevPageId, prevPageData.steps.length - 1);
                    }
                    updateNavButtons();
                });

                document.querySelector('.next-step-btn').addEventListener('click', () => {
                     const pageKeys = Object.keys(tutorialData);
                     const currentPageIndex = pageKeys.indexOf(currentPage);

                    if (currentStep < pageData.steps.length - 1) {
                        currentStep++;
                        updateStep();
                    } else if (currentPageIndex < pageKeys.length - 1) {
                        renderPage(pageKeys[currentPageIndex + 1]);
                    }
                    updateNavButtons();
                });

                // Update sidebar active state
                toc.querySelectorAll('a').forEach(link => {
                    if (link.getAttribute('data-page') === pageId) {
                        link.classList.add('nav-active');
                    } else {
                        link.classList.remove('nav-active');
                    }
                });
            }

            function updateStep() {
                const pageData = tutorialData[currentPage];
                const stepData = pageData.steps[currentStep];

                document.querySelectorAll('.step-content').forEach(el => {
                    el.classList.remove('active');
                });
                const activeStepEl = document.querySelector(`.step-content[data-step="${currentStep}"]`);
                if (activeStepEl) {
                    activeStepEl.classList.add('active');
                }
                
                currentCode = stepData.code.trim();
                codeTitle.textContent = stepData.title;
                codeDisplay.innerHTML = Prism.highlight(currentCode, Prism.languages.python, 'python');
            }

            function updateNavButtons() {
                const prevBtn = document.querySelector('.prev-step-btn');
                const nextBtn = document.querySelector('.next-step-btn');
                if (!prevBtn || !nextBtn) return;

                const pageData = tutorialData[currentPage];
                const pageKeys = Object.keys(tutorialData);
                const currentPageIndex = pageKeys.indexOf(currentPage);

                prevBtn.disabled = (currentPageIndex === 0 && currentStep === 0);
                nextBtn.disabled = (currentPageIndex === pageKeys.length - 1 && currentStep === pageData.steps.length - 1);
            }

            // Build sidebar
            Object.keys(tutorialData).forEach(pageId => {
                const pageData = tutorialData[pageId];
                const li = document.createElement('li');
                li.innerHTML = `<a href="#" data-page="${pageId}" class="block border-l-4 border-transparent px-4 py-2 text-slate-600 hover:bg-slate-100 hover:text-slate-900 transition-colors">${pageData.title}</a>`;
                toc.appendChild(li);
            });

            // Sidebar click listeners
            toc.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = e.target.getAttribute('data-page');
                    renderPage(pageId);
                    if (window.innerWidth < 768) {
                        sidebar.classList.add('-translate-x-full');
                    }
                });
            });

            copyButton.addEventListener('click', () => {
                if (currentCode) {
                    navigator.clipboard.writeText(currentCode).then(() => {
                        copyButton.textContent = 'å·²è¤‡è£½!';
                        setTimeout(() => {
                            copyButton.textContent = 'è¤‡è£½';
                        }, 2000);
                    });
                }
            });

            // Toggle Code Viewer
            toggleCodeBtn.addEventListener('click', () => {
                const isHidden = codeViewerContainer.classList.toggle('hidden');
                mainGrid.classList.toggle('lg:grid-cols-2');
                toggleCodeBtn.textContent = isHidden ? 'é¡¯ç¤ºç¨‹å¼ç¢¼' : 'éš±è—ç¨‹å¼ç¢¼';
            });

            // Initial render
            renderPage('intro');

            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
            });
        });
    </script>
</body>
</html>
